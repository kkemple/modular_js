/* ModJS
 * 2013-10-15
 * Author: Kurtis Kemple
 * Email: kurtiskemple@gmail.com
 * URL: http://kurtiskemple.com
 */
var MOD={};MOD.core=function(){var a={},b=this;return this.util={debug:!0,log:function(a,b){this.debug&&console[1===a?"log":2===a?"warn":"error"](b)},to_string:function(a){return a.toString()},trim:function(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")},to_camel_case:function(a,b){var c;switch(b){case" ":b="\\s";break;default:b="-"}return c=new RegExp(b+"([a-z])","gi"),a.replace(c,function(a,b){return b.toUpperCase()})},is_object:function(a){return"object"==typeof a&&"[object Object]"===Object.prototype.toString.call(a)?!0:!1},is_array:function(a){return"object"==typeof a&&"[object Array]"===Object.prototype.toString.call(a)?!0:!1},array_contains:function(a,b){var c=0,d=a.length;if("object"!=typeof a&&"[object Array]"!==Object.prototype.toString.call(a))return this.log(1,'ARRAY : CONTAINS : FAILED : "Array argument is of wrong type"'),void 0;for(;d>c;){if(a[c]===b)return!0;++c}return!1},map:function(a,b,c){var d=[],e=0;if(c=c?c:null,"function"==typeof b){for(;a[e];)d.push(b.call(c,a[e],e)),++e;return d}this.log(1,'UTIL : MAP : FAILED : "One or more arguments are of wrong type"')},ajax:function(a){if(a&&a.url&&a.scope&&a.done&&a.fail){var b=jQuery.ajax({url:a.url,data:a.data,type:a.type?a.type:"GET",dataType:a.dataType?a.dataType:"JSON"});b.done(function(b){a.done.call(a.scope,b)}),b.fail(function(b,c){var d={message:c,XHR:b};a.fail.call(a.scope,d)})}else this.log(1,'AJAX : FAILED : "Incomplete config for request, see docs for full config example"')},isIE:function(a,b){function c(){var a=-1,c=b,d=new RegExp(/MSIE ([0-9]{1,}[\.0-9]{0,})/);return null!==d.exec(c)&&(a=parseFloat(RegExp.$1)),a}var d=!1,e=c();return e>-1&&(a&&a>=e||!a)&&(d=!0),d}},this.dom={query:function(a,c){var d,e={};return d=c&&c.find?c.find(a):jQuery(a),e=d.get(),e.length=d.length,e.query=function(a){return b.dom.query(a,d)},e},bind:function(a,c,d){a&&"string"==typeof c?jQuery(a).on(c,d):b.util.log(2,'Event "'+c+'" : Attachment : FAILED : "Event attachment to element: '+a+' failed."')},unbind:function(a,c,d){a&&"string"==typeof c?jQuery(a).off(c,d):b.util.log(2,'Event "'+c+'" : Removal : FAILED : "Event removal on element: '+a+' failed."')},create:function(a){var c,d,e,f;if(!a||!a.el)return b.util.log(1,'CREATE : ELEMENT : FAILED : "Incorrect configuration for element creation"'),!1;if(e=document.createElement(a.el),a.text&&e.appendChild(document.createTextNode(a.text)),a.attrs&&(b.util.is_object(a.attrs)?b.dom.apply_attrs(e,a.attrs):b.log(1,'CREATE : ELEMENT : FAILED : "config.attrs is of wrong type')),a.children)if(b.util.is_array(a.children))for(c=0,d=a.children.length;d>c;)f=b.dom.create(a.children[c]),a.children[c].attrs&&b.dom.apply_attrs(f,a.children[c].attrs),e.appendChild(f),++c;else b.util.log(1,'CREATE : ELEMENT : FAILED : "config.children is of wrong type"');return delete a,e},apply_attrs:function(a,c){if(b.util.is_object(c))for(var d in c)c.hasOwnProperty(d)&&a.setAttribute(d,c[d]);else b.util.log(1,'APPLY ATTRIBUTES : FAILED : "Attributes argument is of wrong type."')},prop:function(a,b,c){return void 0===c?a.getAttribute(b):(a.setAttribute(b,c),void 0)},offset:function(a){var b=function(){return null!==window.pageXOffset?{x:window.pageXOffset,y:window.pageYOffset}:{x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop}}(),c=a.getBoundingClientRect();return{x:Math.floor(c.left+b.x),y:Math.floor(c.top+b.y)}},style:function(a,c){var d,e;for(e in c)c.hasOwnProperty(e)&&(d=b.util.to_camel_case(e),a.style[d]=c[e])},add_class:function(a,c){for(var d=c.split(/\s+/),e=" "+a.className+" ",f=e.split(/\s+/),g=d.length,h=0;g>h;)b.util.array_contains(f,d[h])||(e=e+" "+d[h]),++h;a.className=b.util.trim(e)},remove_class:function(a,c){for(var d=c.split(/\s+/),e=" "+a.className+" ",f=d.length,g=0;f>g;)e=e.replace(" "+d[g]+" "," "),++g;a.className=b.util.trim(e)},has_class:function(a,c){var d=a.className,e=d.split(/\s+/);return b.util.array_contains(e,c)?!0:!1},append_elems:function(a,b){"string"==typeof b?a.innerHTML=a.innerHTML+b:a.appendChild(b)},prepend_elems:function(a,b){"string"==typeof b?a.innerHTML=b+a.innerHTML:a.insertBefore(b,a.firstChild)},onready:function(a){jQuery(document).ready(function(){a.call()})},onload:function(a){jQuery("window").on("load",function(){a.call()})}},{util:this.util,dom:this.dom,create_module:function(c,d){var e;return"string"==typeof c&&"function"==typeof d?(e=d(MOD.sandbox.create(this,c)),e.init&&e.destroy&&"function"==typeof e.init&&"function"==typeof e.destroy?(e=null,a[c]={create:d,instance:null,evts:null},!0):(b.util.log(1,'Module : "'+c+'"" : Registration : FAILED : "Instance has either no init or no destroy method"'),!1)):(b.util.log(1,'Module : "'+b.util.to_string(c)+'"" : Registration : FAILED : "One or more arguments are of wrong type"'),!1)},start:function(c){var d=a[c];return d?(d.instance=d.create(MOD.sandbox.create(this,c)),d.instance.init(),!0):(b.util.log(1,'Module : "'+c+'"" : Stop : FAILED : "No module by that ID"'),!1)},start_all:function(){var b;for(b in a)if(a.hasOwnProperty(b)&&!this.start(b))return!1;return!0},stop:function(c){var d=a[c];return d.instance?(d.instance.destroy(),d.instance=null,!0):(b.util.log(1,'Module : "'+c+'"" : Stop : FAILED : "No module by that ID or no running module by that ID"'),!1)},stop_all:function(){var b;for(var b in a)if(a.hasOwnProperty(b)&&!this.stop(b))return!1;return!0},register_events:function(c,d){if(this.util.is_object(c)&&d){var e=a[d];return e?(e.evts=c,!0):(b.util.log(1,'Module : "'+d+'"" : Register Events : FAILED : "No module by that ID"'),!1)}return b.util.log(1,'Module : "'+d+'"" : Register Events : FAILED : "One or more arguments are of wrong type'),!1},trigger_event:function(c){var d;if(this.util.is_object(c)&&c.type){for(d in a)a.hasOwnProperty(d)&&(d=a[d],d.evts&&d.evts[c.type]&&d.evts[c.type](c.data));return!0}return b.util.log(1,'Event : "'+this.util.to_string(c.type)+'"" : Trigger Event : FAILED : "Event object is of wrong type or there is no event type specified"'),!1},remove_events:function(c,d){if(b.util.is_array(c)&&d){var e=a[d];if(e){var f=0;for(c.length;c[f];)e.evts[c[f]]&&delete e.evts[c[f]],++f;return!0}return b.util.log(1,'Module : "'+d+'"" : Remove Events : FAILED : "No module by that ID"'),!1}return b.util.log(1,'Module : "'+d+'"" : Remove Events : FAILED : "One or more arguments are of wrong type"'),!1}}}(),MOD.app=function(){return start_on_ready=function(a){for(var b=a.length,c=0;b>c;)MOD.core.start(a[c]),++c},start_on_load=function(a){for(var b=a.length,c=0;b>c;)MOD.core.start(a[c]),++c},{run:function(){MOD.core.util.debug=MOD.config.debug?MOD.config.debug:!0,MOD.config.onready&&MOD.core.dom.onready(function(){start_on_ready(MOD.config.onready.modules)}),MOD.config.onload&&MOD.core.dom.onload(function(){start_on_load(MOD.config.onload.modules)})}}}(),MOD.sandbox={create:function(a,b){var c=a.dom.query("#"+b);return{find:function(a){return c.query(a)},add_event:function(b,c,d){a.dom.bind(b,c,d)},remove_event:function(b,c,d){a.dom.unbind(b,c,d)},notify:function(b){a.trigger_event(b)},listen:function(c){a.register_events(c,b)},ignore:function(b,c){a.remove_events(b,c)},create_element:function(b){return a.dom.create(b)},append:function(b,c){a.dom.append_elems(b,c)},prepend:function(b,c){a.dom.prepend_elems(b,c)},request:function(b){a.util.ajax(b)},modify:function(b,c,d){switch(c){case"add-class":a.dom.add_class(b,d);break;case"remove-class":a.dom.remove_class(b,d);break;case"styles":a.dom.style(b,d);break;case"attr":a.dom.apply_attrs(d)}},attr:function(b,c,d){a.dom.prop(b,c,d)},offset:function(b){return a.dom.offset(b)},has_class:function(b,c){return a.dom.has_class(b,c)},animate:function(b,c,d,e,f){a.dom.animate(b,c,d,e,f)},foreach:function(b,c,d){return a.util.map(b,c,d)}}}},MOD.form=function(a){var b,c,d,e,f,g,h;return f={init:function(a){g=a.elements,b=a.getElementsByClassName("validate")},validate:function(){return d=!1,f.clear_errors(),MOD.core.util.map(b,function(a){c=a,MOD.core.dom.has_class(a,"required")&&f.check.required(a),MOD.core.dom.has_class(a,"email")&&f.check.email(a),MOD.core.dom.has_class(a,"phone")&&f.check.phone(a),MOD.core.dom.has_class(a,"url")&&f.check.url(a),MOD.core.dom.has_class(a,"creditcard")&&f.check.credit_card(a),MOD.core.dom.has_class(a,"minlength")&&f.check.min_length(a),MOD.core.dom.has_class(a,"maxlength")&&f.check.max_length(a),MOD.core.dom.has_class(a,"equalto")&&f.check.equal_to(a)}),d!==!0?!0:!1},set_error:function(b){if(e=a.getElementsByClassName("errors")[0],!e){var d={el:"div",attrs:{"class":"errors"}};e=MOD.core.dom.create(d),a.insertBefore(e,a.firstChild)}MOD.core.dom.add_class(c,"error");var f={el:"p",text:b,attrs:{"class":"error-list-item"}};e.appendChild(MOD.core.dom.create(f))},clear_errors:function(){MOD.core.util.map(b,function(a){MOD.core.dom.remove_class(a,"error")}),e&&(e.innerHTML=null)},prep:function(b){b=b?b:!1,h={};var c,d=[];if(MOD.core.util.map(g,function(b){var c=b.tagName.toLowerCase();switch(c){case"input":var d=b.type;switch(d){case"text":case"email":case"password":case"phone":case"url":h[b.name]=b.value;break;case"checkbox":h[b.name]=b.checked?"1":"0";break;case"radio":var e=!1;MOD.core.util.map(a[b.name],function(a){a.checked&&(h[b.name]=a.value,e=!0)}),e||(h[b.name]="0")}break;case"textarea":h[b.name]=b.value;break;case"select":if(b.multiple)if(-1!==b.selectedIndex){var f=[];MOD.core.util.map(b.options,function(a){a.selected===!0&&f.push(a.value)}),h[b.name]=f}else h[b.name]=[];else h[b.name]=-1!==b.selectedIndex?b.options[b.selectedIndex].value:""}}),!h)return"";if(b){for(c in h)if(h.hasOwnProperty(c)&&"function"!=typeof h){var e=h[c].toString();c=encodeURIComponent(c).replace(/\%20/g,"+"),e=encodeURIComponent(e).replace(/\%20/g,"+"),d.push(c+"="+e)}return d.join("&")}return JSON.stringify(h)},check:{required:function(a){var c=a.tagName.toLowerCase();switch(c){case"input":var e=a.type;switch(e){case"text":case"email":case"password":case"phone":case"url":a.value.length<1&&(d=!0,f.set_error("One or more fields are required."));break;case"checkbox":a.checked===!1&&(d=!0,f.set_error("This field is required."));break;case"radio":var g,h,i=a.name,j=!1,k=[];for(MOD.core.util.map(b,function(a){a.name===i&&k.push(a)}),g=0,h=k.length;h>g;g++)if(k[g].checked===!0)return j=!0,void 0;j||(d=!0,f.set_error("One or more options is required."))}break;case"textarea":a.value.length<1&&(d=!0,f.set_error("One or more fields are required."));break;case"select":-1===a.options.selectedIndex&&(d=!0,f.set_error("One or more options are required."))}},email:function(a){var b=a.value;arr=b.match(/^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/),null===arr&&(d=!0,f.set_error("Not a valid email address."))},phone:function(a){var b=a.value,c=b.match(/^\(+?[0-9]{3}\)+?\s[0-9]{3}[\s|\.|-][0-9]{4}|^[0-9]{3}[\s|\.|\-][0-9]{3}[\s|\.|-][0-9]{4}|^[0-9]{10}$/);null===c&&(d=!0,f.set_error("Not a valid phone number."))},url:function(a){var b=a.value,c=b.match(/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/);null===c&&(d=!0,f.set_error("Not a valid url."))},credit_card:function(a){var b=a.value,c=b.match(/\d{16}/);null===c&&(d=!0,f.set_error("Not a valid credit card number."))},min_length:function(a){var b=a.tagName.toLowerCase(),c=parseInt(a.getAttribute("data-minlength"),10);switch(b){case"input":switch(type=a.type){case"text":case"email":case"password":case"phone":case"url":a.value.length<c&&(d=!0,f.set_error("Minimum length is "+c+"."))}break;case"textarea":a.value.length<c&&(d=!0,f.set_error("Minimum length is "+c+"."));break;case"select":var e=0;if(a.multiple){for(i=0,len=a.options.length;len>i;i++)a.options[i].selected===!0&&++e;c>e&&(d=!0,f.set_error("Minimum length is "+c+"."))}}},max_length:function(a){var b=a.tagName.toLowerCase(),c=parseInt(a.getAttribute("data-maxlength"),10);switch(b){case"input":var e=a.type;switch(e){case"text":case"email":case"password":case"phone":case"url":a.value.length>c&&(d=!0,f.set_error("Maximum length is "+c+"."))}break;case"textarea":a.value.length>c&&(d=!0,f.set_error("Maximum length is "+c+"."));break;case"select":var g,h,i=0;if(a.multiple){for(g=0,h=a.options.length;h>g;g++)a.options[g].selected===!0&&++i;i>c&&(d=!0,f.set_error("Maximum length is "+c+"."))}}},equal_to:function(a){var b=a.tagName.toLowerCase(),c=parseInt(a.getAttribute("data-equalto"),10);switch(b){case"input":var e=a.type;switch(e){case"text":case"email":case"password":case"phone":case"url":a.value.length!==c&&(d=!0,f.set_error("Minimum length is "+c+"."))}break;case"textarea":a.value.length!==c&&(d=!0,f.set_error("Minimum length is "+c+"."));break;case"select":var g,h,i=0;if(a.multiple){for(g=0,h=a.options.length;h>g;g++)a.options[g].selected===!0&&++i;i!==c&&(d=!0,f.set_error("Minimum length is "+c+"."))}}}}},f.init(a),f},MOD.ui={scroll:function(a){function b(a){e=document.getElementById(a.el),g=a.offset,h=a.duration,i=a.callback,f=document.getElementById(e.href.split("#")[1]),j=PIX.sandbox.create(PIX.core,a.el),j.add_event(e,"click",d)}function c(){j.remove_event(e,"click",d),e=f=g=h=i=null}function d(b){var c=j.offset(f).y,d={"scroll-top":c-g};j.animate("html, body",d,h,i),j.notify({type:"ui.scroll."+a.el,data:null}),b.preventDefault()}var e,f,g,h,i,j,k;return k={update:function(a){c(),b(a)}},b(a),k}};